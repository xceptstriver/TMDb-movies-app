{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false,"locs":[]}},{"name":"@babel/runtime/helpers/defineProperty","data":{"isAsync":false,"locs":[]}},{"name":"react","data":{"isAsync":false,"locs":[]}},{"name":"./NavigationBuilderContext","data":{"isAsync":false,"locs":[]}},{"name":"./NavigationRouteContext","data":{"isAsync":false,"locs":[]}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = useOnPreventRemove;\n  exports.shouldPreventRemove = void 0;\n\n  var _defineProperty2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/defineProperty\"));\n\n  var React = _interopRequireWildcard(_$$_REQUIRE(_dependencyMap[2], \"react\"));\n\n  var _NavigationBuilderContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"./NavigationBuilderContext\"));\n\n  var _NavigationRouteContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"./NavigationRouteContext\"));\n\n  function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\n  function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n  function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\n  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n  var VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n\n  var shouldPreventRemove = function shouldPreventRemove(emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) {\n    var _action$VISITED_ROUTE;\n\n    var nextRouteKeys = nextRoutes.map(function (route) {\n      return route.key;\n    });\n    var removedRoutes = currentRoutes.filter(function (route) {\n      return !nextRouteKeys.includes(route.key);\n    }).reverse();\n    var visitedRouteKeys = (_action$VISITED_ROUTE = action[VISITED_ROUTE_KEYS]) != null ? _action$VISITED_ROUTE : new Set();\n\n    var beforeRemoveAction = _objectSpread(_objectSpread({}, action), {}, (0, _defineProperty2.default)({}, VISITED_ROUTE_KEYS, visitedRouteKeys));\n\n    for (var _iterator = _createForOfIteratorHelperLoose(removedRoutes), _step; !(_step = _iterator()).done;) {\n      var _beforeRemoveListener;\n\n      var route = _step.value;\n\n      if (visitedRouteKeys.has(route.key)) {\n        continue;\n      }\n\n      var isPrevented = (_beforeRemoveListener = beforeRemoveListeners[route.key]) == null ? void 0 : _beforeRemoveListener.call(beforeRemoveListeners, beforeRemoveAction);\n\n      if (isPrevented) {\n        return true;\n      }\n\n      visitedRouteKeys.add(route.key);\n      var event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  exports.shouldPreventRemove = shouldPreventRemove;\n\n  function useOnPreventRemove(_ref) {\n    var getState = _ref.getState,\n        emitter = _ref.emitter,\n        beforeRemoveListeners = _ref.beforeRemoveListeners;\n\n    var _React$useContext = React.useContext(_NavigationBuilderContext.default),\n        addKeyedListener = _React$useContext.addKeyedListener;\n\n    var route = React.useContext(_NavigationRouteContext.default);\n    var routeKey = route == null ? void 0 : route.key;\n    React.useEffect(function () {\n      if (routeKey) {\n        return addKeyedListener == null ? void 0 : addKeyedListener('beforeRemove', routeKey, function (action) {\n          var state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":101,"map":[[12,0,1,0],[14,0,6,0],[16,0,9,0],[32,0,19,0],[32,6,19,6,"VISITED_ROUTE_KEYS"],[32,24,19,24],[32,27,19,27,"Symbol"],[32,33,19,33],[32,34,19,34],[32,54,19,33],[32,55,19,0],[34,0,21,7],[34,6,21,13,"shouldPreventRemove"],[34,25,21,32],[34,28,21,35],[34,37,21,13,"shouldPreventRemove"],[34,56,21,35],[34,57,22,2,"emitter"],[34,64,21,35],[34,66,23,2,"beforeRemoveListeners"],[34,87,21,35],[34,89,24,2,"currentRoutes"],[34,102,21,35],[34,104,25,2,"nextRoutes"],[34,114,21,35],[34,116,26,2,"action"],[34,122,21,35],[34,124,27,5],[35,0,27,5],[37,0,28,2],[37,8,28,8,"nextRouteKeys"],[37,21,28,21],[37,24,28,24,"nextRoutes"],[37,34,28,34],[37,35,28,35,"map"],[37,38,28,24],[37,39,28,39],[37,49,28,40,"route"],[37,54,28,39],[38,0,28,39],[38,13,28,50,"route"],[38,18,28,55],[38,19,28,56,"key"],[38,22,28,39],[39,0,28,39],[39,5,28,24],[39,6,28,2],[40,0,31,2],[40,8,31,8,"removedRoutes"],[40,21,31,21],[40,24,31,24,"currentRoutes"],[40,37,31,37],[40,38,32,5,"filter"],[40,44,31,24],[40,45,32,12],[40,55,32,13,"route"],[40,60,32,12],[41,0,32,12],[41,13,32,23],[41,14,32,24,"nextRouteKeys"],[41,27,32,37],[41,28,32,38,"includes"],[41,36,32,24],[41,37,32,47,"route"],[41,42,32,52],[41,43,32,53,"key"],[41,46,32,24],[41,47,32,12],[42,0,32,12],[42,5,31,24],[42,7,33,5,"reverse"],[42,14,31,24],[42,16,31,2],[43,0,35,2],[43,8,35,8,"visitedRouteKeys"],[43,24,35,37],[43,52,37,4,"action"],[43,58,37,10],[43,59,37,11,"VISITED_ROUTE_KEYS"],[43,77,37,10],[43,78,35,37],[43,114,37,34],[43,118,37,38,"Set"],[43,121,37,34],[43,123,35,2],[45,0,39,2],[45,8,39,8,"beforeRemoveAction"],[45,26,39,26],[45,61,40,7,"action"],[45,67,39,26],[45,108,41,5,"VISITED_ROUTE_KEYS"],[45,126,39,26],[45,128,41,26,"visitedRouteKeys"],[45,144,39,26],[45,146,39,2],[47,0,44,2],[47,57,44,22,"removedRoutes"],[47,70,44,2],[47,110,44,37],[48,0,44,37],[50,0,44,37],[50,10,44,13,"route"],[50,15,44,37],[52,0,45,4],[52,10,45,8,"visitedRouteKeys"],[52,26,45,24],[52,27,45,25,"has"],[52,30,45,8],[52,31,45,29,"route"],[52,36,45,34],[52,37,45,35,"key"],[52,40,45,8],[52,41,45,4],[52,43,45,41],[53,0,47,6],[54,0,48,5],[56,0,51,4],[56,10,51,10,"isPrevented"],[56,21,51,21],[56,49,51,24,"beforeRemoveListeners"],[56,70,51,45],[56,71,51,46,"route"],[56,76,51,51],[56,77,51,52,"key"],[56,80,51,45],[56,81,51,21],[56,102,51,24],[56,129,51,24,"beforeRemoveListeners"],[56,150,51,45],[56,152,51,59,"beforeRemoveAction"],[56,170,51,45],[56,171,51,4],[58,0,53,4],[58,10,53,8,"isPrevented"],[58,21,53,4],[58,23,53,21],[59,0,54,6],[59,15,54,13],[59,19,54,6],[60,0,55,5],[62,0,57,4,"visitedRouteKeys"],[62,6,57,4,"visitedRouteKeys"],[62,22,57,20],[62,23,57,21,"add"],[62,26,57,4],[62,27,57,25,"route"],[62,32,57,30],[62,33,57,31,"key"],[62,36,57,4],[63,0,59,4],[63,10,59,10,"event"],[63,15,59,15],[63,18,59,18,"emitter"],[63,25,59,25],[63,26,59,26,"emit"],[63,30,59,18],[63,31,59,31],[64,0,60,6,"type"],[64,8,60,6,"type"],[64,12,60,10],[64,14,60,12],[64,28,59,31],[65,0,61,6,"target"],[65,8,61,6,"target"],[65,14,61,12],[65,16,61,14,"route"],[65,21,61,19],[65,22,61,20,"key"],[65,25,59,31],[66,0,62,6,"data"],[66,8,62,6,"data"],[66,12,62,10],[66,14,62,12],[67,0,62,14,"action"],[67,10,62,14,"action"],[67,16,62,20],[67,18,62,22,"beforeRemoveAction"],[68,0,62,12],[68,9,59,31],[69,0,63,6,"canPreventDefault"],[69,8,63,6,"canPreventDefault"],[69,25,63,23],[69,27,63,25],[70,0,59,31],[70,7,59,18],[70,8,59,4],[72,0,66,4],[72,10,66,8,"event"],[72,15,66,13],[72,16,66,14,"defaultPrevented"],[72,32,66,4],[72,34,66,32],[73,0,67,6],[73,15,67,13],[73,19,67,6],[74,0,68,5],[75,0,69,3],[77,0,71,2],[77,11,71,9],[77,16,71,2],[78,0,72,1],[78,3,21,7],[82,0,74,15],[82,11,74,24,"useOnPreventRemove"],[82,29,74,15],[82,36,78,12],[83,0,78,12],[83,8,75,2,"getState"],[83,16,78,12],[83,24,75,2,"getState"],[83,32,78,12],[84,0,78,12],[84,8,76,2,"emitter"],[84,15,78,12],[84,23,76,2,"emitter"],[84,30,78,12],[85,0,78,12],[85,8,77,2,"beforeRemoveListeners"],[85,29,78,12],[85,37,77,2,"beforeRemoveListeners"],[85,58,78,12],[87,0,79,2],[87,28,79,31,"React"],[87,33,79,36],[87,34,79,37,"useContext"],[87,44,79,31],[87,45,79,48,"NavigationBuilderContext"],[87,78,79,31],[87,79,79,2],[88,0,79,2],[88,8,79,10,"addKeyedListener"],[88,24,79,2],[88,45,79,10,"addKeyedListener"],[88,61,79,2],[90,0,80,2],[90,8,80,8,"route"],[90,13,80,13],[90,16,80,16,"React"],[90,21,80,21],[90,22,80,22,"useContext"],[90,32,80,16],[90,33,80,33,"NavigationRouteContext"],[90,64,80,16],[90,65,80,2],[91,0,81,2],[91,8,81,8,"routeKey"],[91,16,81,16],[91,19,81,19,"route"],[91,24,81,16],[91,44,81,19,"route"],[91,49,81,24],[91,50,81,26,"key"],[91,53,81,2],[92,0,83,2,"React"],[92,4,83,2,"React"],[92,9,83,7],[92,10,83,8,"useEffect"],[92,19,83,2],[92,20,83,18],[92,32,83,24],[93,0,84,4],[93,10,84,8,"routeKey"],[93,18,84,4],[93,20,84,18],[94,0,85,6],[94,15,85,13,"addKeyedListener"],[94,31,85,6],[94,51,85,13,"addKeyedListener"],[94,67,85,29],[94,68,85,32],[94,82,85,29],[94,84,85,48,"routeKey"],[94,92,85,29],[94,94,85,58],[94,104,85,59,"action"],[94,110,85,58],[94,112,85,70],[95,0,86,8],[95,14,86,14,"state"],[95,19,86,19],[95,22,86,22,"getState"],[95,30,86,30],[95,32,86,8],[96,0,88,8],[96,17,88,15,"shouldPreventRemove"],[96,36,88,34],[96,37,89,10,"emitter"],[96,44,88,34],[96,46,90,10,"beforeRemoveListeners"],[96,67,88,34],[96,69,91,10,"state"],[96,74,91,15],[96,75,91,16,"routes"],[96,81,88,34],[96,83,92,10],[96,85,88,34],[96,87,93,10,"action"],[96,93,88,34],[96,94,88,8],[97,0,95,7],[97,9,85,29],[97,10,85,6],[98,0,96,5],[99,0,97,3],[99,5,83,2],[99,7,97,5],[99,8,97,6,"addKeyedListener"],[99,24,97,5],[99,26,97,24,"beforeRemoveListeners"],[99,47,97,5],[99,49,97,47,"emitter"],[99,56,97,5],[99,58,97,56,"getState"],[99,66,97,5],[99,68,97,66,"routeKey"],[99,76,97,5],[99,77,83,2],[100,0,98,1]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","<anonymous>"],"mappings":"AAA;mCCoB;uCCO,oBD;YEI,6CF;CDwC;eIE;kBCS;0DCE;ODU;GDE;CJC"}},"type":"js/module"}]}
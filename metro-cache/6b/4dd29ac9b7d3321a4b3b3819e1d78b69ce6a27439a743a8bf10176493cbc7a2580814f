{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false,"locs":[]}},{"name":"react","data":{"isAsync":false,"locs":[]}},{"name":"./NavigationBuilderContext","data":{"isAsync":false,"locs":[]}},{"name":"./useOnPreventRemove","data":{"isAsync":false,"locs":[]}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = useOnAction;\n\n  var React = _interopRequireWildcard(_$$_REQUIRE(_dependencyMap[1], \"react\"));\n\n  var _NavigationBuilderContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"./NavigationBuilderContext\"));\n\n  var _useOnPreventRemove = _interopRequireWildcard(_$$_REQUIRE(_dependencyMap[3], \"./useOnPreventRemove\"));\n\n  function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\n  function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n  function useOnAction(_ref) {\n    var router = _ref.router,\n        getState = _ref.getState,\n        setState = _ref.setState,\n        key = _ref.key,\n        actionListeners = _ref.actionListeners,\n        beforeRemoveListeners = _ref.beforeRemoveListeners,\n        routerConfigOptions = _ref.routerConfigOptions,\n        emitter = _ref.emitter;\n\n    var _React$useContext = React.useContext(_NavigationBuilderContext.default),\n        onActionParent = _React$useContext.onAction,\n        onRouteFocusParent = _React$useContext.onRouteFocus,\n        addListenerParent = _React$useContext.addListener,\n        onDispatchAction = _React$useContext.onDispatchAction;\n\n    var routerConfigOptionsRef = React.useRef(routerConfigOptions);\n    React.useEffect(function () {\n      routerConfigOptionsRef.current = routerConfigOptions;\n    });\n    var onAction = React.useCallback(function (action) {\n      var visitedNavigators = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Set();\n      var state = getState();\n\n      if (visitedNavigators.has(state.key)) {\n        return false;\n      }\n\n      visitedNavigators.add(state.key);\n\n      if (typeof action.target !== 'string' || action.target === state.key) {\n        var result = router.getStateForAction(state, action, routerConfigOptionsRef.current);\n        result = result === null && action.target === state.key ? state : result;\n\n        if (result !== null) {\n          onDispatchAction(action, state === result);\n\n          if (state !== result) {\n            var isPrevented = (0, _useOnPreventRemove.shouldPreventRemove)(emitter, beforeRemoveListeners, state.routes, result.routes, action);\n\n            if (isPrevented) {\n              return true;\n            }\n\n            setState(result);\n          }\n\n          if (onRouteFocusParent !== undefined) {\n            var shouldFocus = router.shouldActionChangeFocus(action);\n\n            if (shouldFocus && key !== undefined) {\n              onRouteFocusParent(key);\n            }\n          }\n\n          return true;\n        }\n      }\n\n      if (onActionParent !== undefined) {\n        if (onActionParent(action, visitedNavigators)) {\n          return true;\n        }\n      }\n\n      for (var i = actionListeners.length - 1; i >= 0; i--) {\n        var listener = actionListeners[i];\n\n        if (listener(action, visitedNavigators)) {\n          return true;\n        }\n      }\n\n      return false;\n    }, [actionListeners, beforeRemoveListeners, emitter, getState, key, onActionParent, onDispatchAction, onRouteFocusParent, router, setState]);\n    (0, _useOnPreventRemove.default)({\n      getState: getState,\n      emitter: emitter,\n      beforeRemoveListeners: beforeRemoveListeners\n    });\n    React.useEffect(function () {\n      return addListenerParent == null ? void 0 : addListenerParent('action', onAction);\n    }, [addListenerParent, onAction]);\n    return onAction;\n  }\n});","lineCount":104,"map":[[9,0,1,0],[11,0,9,0],[13,0,13,0],[19,0,37,15],[19,11,37,24,"useOnAction"],[19,22,37,15],[19,29,46,12],[20,0,46,12],[20,8,38,2,"router"],[20,14,46,12],[20,22,38,2,"router"],[20,28,46,12],[21,0,46,12],[21,8,39,2,"getState"],[21,16,46,12],[21,24,39,2,"getState"],[21,32,46,12],[22,0,46,12],[22,8,40,2,"setState"],[22,16,46,12],[22,24,40,2,"setState"],[22,32,46,12],[23,0,46,12],[23,8,41,2,"key"],[23,11,46,12],[23,19,41,2,"key"],[23,22,46,12],[24,0,46,12],[24,8,42,2,"actionListeners"],[24,23,46,12],[24,31,42,2,"actionListeners"],[24,46,46,12],[25,0,46,12],[25,8,43,2,"beforeRemoveListeners"],[25,29,46,12],[25,37,43,2,"beforeRemoveListeners"],[25,58,46,12],[26,0,46,12],[26,8,44,2,"routerConfigOptions"],[26,27,46,12],[26,35,44,2,"routerConfigOptions"],[26,54,46,12],[27,0,46,12],[27,8,45,2,"emitter"],[27,15,46,12],[27,23,45,2,"emitter"],[27,30,46,12],[29,0,47,2],[29,28,52,6,"React"],[29,33,52,11],[29,34,52,12,"useContext"],[29,44,52,6],[29,45,52,23,"NavigationBuilderContext"],[29,78,52,6],[29,79,47,2],[30,0,47,2],[30,8,48,14,"onActionParent"],[30,22,47,2],[30,43,48,4,"onAction"],[30,51,47,2],[31,0,47,2],[31,8,49,18,"onRouteFocusParent"],[31,26,47,2],[31,47,49,4,"onRouteFocus"],[31,59,47,2],[32,0,47,2],[32,8,50,17,"addListenerParent"],[32,25,47,2],[32,46,50,4,"addListener"],[32,57,47,2],[33,0,47,2],[33,8,51,4,"onDispatchAction"],[33,24,47,2],[33,45,51,4,"onDispatchAction"],[33,61,47,2],[35,0,54,2],[35,8,54,8,"routerConfigOptionsRef"],[35,30,54,30],[35,33,54,33,"React"],[35,38,54,38],[35,39,54,39,"useRef"],[35,45,54,33],[35,46,55,4,"routerConfigOptions"],[35,65,54,33],[35,66,54,2],[36,0,58,2,"React"],[36,4,58,2,"React"],[36,9,58,7],[36,10,58,8,"useEffect"],[36,19,58,2],[36,20,58,18],[36,32,58,24],[37,0,59,4,"routerConfigOptionsRef"],[37,6,59,4,"routerConfigOptionsRef"],[37,28,59,26],[37,29,59,27,"current"],[37,36,59,4],[37,39,59,37,"routerConfigOptions"],[37,58,59,4],[38,0,60,3],[38,5,58,2],[39,0,62,2],[39,8,62,8,"onAction"],[39,16,62,16],[39,19,62,19,"React"],[39,24,62,24],[39,25,62,25,"useCallback"],[39,36,62,19],[39,37,63,4],[39,47,64,6,"action"],[39,53,63,4],[39,55,66,9],[40,0,66,9],[40,10,65,6,"visitedNavigators"],[40,27,66,9],[40,98,65,39],[40,102,65,43,"Set"],[40,105,65,39],[40,107,66,9],[41,0,67,6],[41,10,67,12,"state"],[41,15,67,17],[41,18,67,20,"getState"],[41,26,67,28],[41,28,67,6],[43,0,71,6],[43,10,71,10,"visitedNavigators"],[43,27,71,27],[43,28,71,28,"has"],[43,31,71,10],[43,32,71,32,"state"],[43,37,71,37],[43,38,71,38,"key"],[43,41,71,10],[43,42,71,6],[43,44,71,44],[44,0,72,8],[44,15,72,15],[44,20,72,8],[45,0,73,7],[47,0,75,6,"visitedNavigators"],[47,6,75,6,"visitedNavigators"],[47,23,75,23],[47,24,75,24,"add"],[47,27,75,6],[47,28,75,28,"state"],[47,33,75,33],[47,34,75,34,"key"],[47,37,75,6],[49,0,77,6],[49,10,77,10],[49,17,77,17,"action"],[49,23,77,23],[49,24,77,24,"target"],[49,30,77,10],[49,35,77,35],[49,43,77,10],[49,47,77,47,"action"],[49,53,77,53],[49,54,77,54,"target"],[49,60,77,47],[49,65,77,65,"state"],[49,70,77,70],[49,71,77,71,"key"],[49,74,77,6],[49,76,77,76],[50,0,78,8],[50,12,78,12,"result"],[50,18,78,18],[50,21,78,21,"router"],[50,27,78,27],[50,28,78,28,"getStateForAction"],[50,45,78,21],[50,46,79,10,"state"],[50,51,78,21],[50,53,80,10,"action"],[50,59,78,21],[50,61,81,10,"routerConfigOptionsRef"],[50,83,81,32],[50,84,81,33,"current"],[50,91,78,21],[50,92,78,8],[51,0,86,8,"result"],[51,8,86,8,"result"],[51,14,86,14],[51,17,87,10,"result"],[51,23,87,16],[51,28,87,21],[51,32,87,10],[51,36,87,29,"action"],[51,42,87,35],[51,43,87,36,"target"],[51,49,87,29],[51,54,87,47,"state"],[51,59,87,52],[51,60,87,53,"key"],[51,63,87,10],[51,66,87,59,"state"],[51,71,87,10],[51,74,87,67,"result"],[51,80,86,8],[53,0,89,8],[53,12,89,12,"result"],[53,18,89,18],[53,23,89,23],[53,27,89,8],[53,29,89,29],[54,0,90,10,"onDispatchAction"],[54,10,90,10,"onDispatchAction"],[54,26,90,26],[54,27,90,27,"action"],[54,33,90,26],[54,35,90,35,"state"],[54,40,90,40],[54,45,90,45,"result"],[54,51,90,26],[54,52,90,10],[56,0,92,10],[56,14,92,14,"state"],[56,19,92,19],[56,24,92,24,"result"],[56,30,92,10],[56,32,92,32],[57,0,93,12],[57,16,93,18,"isPrevented"],[57,27,93,29],[57,30,93,32],[57,75,94,14,"emitter"],[57,82,93,32],[57,84,95,14,"beforeRemoveListeners"],[57,105,93,32],[57,107,96,14,"state"],[57,112,96,19],[57,113,96,20,"routes"],[57,119,93,32],[57,121,97,14,"result"],[57,127,97,20],[57,128,97,21,"routes"],[57,134,93,32],[57,136,98,14,"action"],[57,142,93,32],[57,143,93,12],[59,0,101,12],[59,16,101,16,"isPrevented"],[59,27,101,12],[59,29,101,29],[60,0,102,14],[60,21,102,21],[60,25,102,14],[61,0,103,13],[63,0,105,12,"setState"],[63,12,105,12,"setState"],[63,20,105,20],[63,21,105,21,"result"],[63,27,105,20],[63,28,105,12],[64,0,106,11],[66,0,108,10],[66,14,108,14,"onRouteFocusParent"],[66,32,108,32],[66,37,108,37,"undefined"],[66,46,108,10],[66,48,108,48],[67,0,111,12],[67,16,111,18,"shouldFocus"],[67,27,111,29],[67,30,111,32,"router"],[67,36,111,38],[67,37,111,39,"shouldActionChangeFocus"],[67,60,111,32],[67,61,111,63,"action"],[67,67,111,32],[67,68,111,12],[69,0,113,12],[69,16,113,16,"shouldFocus"],[69,27,113,27],[69,31,113,31,"key"],[69,34,113,34],[69,39,113,39,"undefined"],[69,48,113,12],[69,50,113,50],[70,0,114,14,"onRouteFocusParent"],[70,14,114,14,"onRouteFocusParent"],[70,32,114,32],[70,33,114,33,"key"],[70,36,114,32],[70,37,114,14],[71,0,115,13],[72,0,116,11],[74,0,118,10],[74,17,118,17],[74,21,118,10],[75,0,119,9],[76,0,120,7],[78,0,122,6],[78,10,122,10,"onActionParent"],[78,24,122,24],[78,29,122,29,"undefined"],[78,38,122,6],[78,40,122,40],[79,0,124,8],[79,12,124,12,"onActionParent"],[79,26,124,26],[79,27,124,27,"action"],[79,33,124,26],[79,35,124,35,"visitedNavigators"],[79,52,124,26],[79,53,124,8],[79,55,124,55],[80,0,125,10],[80,17,125,17],[80,21,125,10],[81,0,126,9],[82,0,127,7],[84,0,130,6],[84,11,130,11],[84,15,130,15,"i"],[84,16,130,16],[84,19,130,19,"actionListeners"],[84,34,130,34],[84,35,130,35,"length"],[84,41,130,19],[84,44,130,44],[84,45,130,6],[84,47,130,47,"i"],[84,48,130,48],[84,52,130,52],[84,53,130,6],[84,55,130,55,"i"],[84,56,130,56],[84,58,130,6],[84,60,130,60],[85,0,131,8],[85,12,131,14,"listener"],[85,20,131,22],[85,23,131,25,"actionListeners"],[85,38,131,40],[85,39,131,41,"i"],[85,40,131,40],[85,41,131,8],[87,0,133,8],[87,12,133,12,"listener"],[87,20,133,20],[87,21,133,21,"action"],[87,27,133,20],[87,29,133,29,"visitedNavigators"],[87,46,133,20],[87,47,133,8],[87,49,133,49],[88,0,134,10],[88,17,134,17],[88,21,134,10],[89,0,135,9],[90,0,136,7],[92,0,138,6],[92,13,138,13],[92,18,138,6],[93,0,139,5],[93,5,62,19],[93,7,140,4],[93,8,141,6,"actionListeners"],[93,23,140,4],[93,25,142,6,"beforeRemoveListeners"],[93,46,140,4],[93,48,143,6,"emitter"],[93,55,140,4],[93,57,144,6,"getState"],[93,65,140,4],[93,67,145,6,"key"],[93,70,140,4],[93,72,146,6,"onActionParent"],[93,86,140,4],[93,88,147,6,"onDispatchAction"],[93,104,140,4],[93,106,148,6,"onRouteFocusParent"],[93,124,140,4],[93,126,149,6,"router"],[93,132,140,4],[93,134,150,6,"setState"],[93,142,140,4],[93,143,62,19],[93,144,62,2],[94,0,154,2],[94,37,154,21],[95,0,155,4,"getState"],[95,6,155,4,"getState"],[95,14,155,12],[95,16,155,4,"getState"],[95,24,154,21],[96,0,156,4,"emitter"],[96,6,156,4,"emitter"],[96,13,156,11],[96,15,156,4,"emitter"],[96,22,154,21],[97,0,157,4,"beforeRemoveListeners"],[97,6,157,4,"beforeRemoveListeners"],[97,27,157,25],[97,29,157,4,"beforeRemoveListeners"],[98,0,154,21],[98,5,154,2],[99,0,160,2,"React"],[99,4,160,2,"React"],[99,9,160,7],[99,10,160,8,"useEffect"],[99,19,160,2],[99,20,160,18],[100,0,160,18],[100,13,160,24,"addListenerParent"],[100,30,160,18],[100,50,160,24,"addListenerParent"],[100,67,160,41],[100,68,160,44],[100,76,160,41],[100,78,160,54,"onAction"],[100,86,160,41],[100,87,160,18],[101,0,160,18],[101,5,160,2],[101,7,160,65],[101,8,161,4,"addListenerParent"],[101,25,160,65],[101,27,162,4,"onAction"],[101,35,160,65],[101,36,160,2],[102,0,165,2],[102,11,165,9,"onAction"],[102,19,165,2],[103,0,166,1]],"functionMap":{"names":["<global>","useOnAction","React.useEffect$argument_0","React.useCallback$argument_0"],"mappings":"AAA;eCoC;kBCqB;GDE;IEG;KF4E;kBCqB,6CD;CDM"}},"type":"js/module"}]}